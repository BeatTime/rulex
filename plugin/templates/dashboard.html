<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>RulengineX-Dashboard</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

</head>

<body>
    <div id="app">
        <el-container>
            <el-header>
                <el-menu class="el-menu-demo" mode="horizontal" background-color="#545c64" text-color="#fff"
                    active-text-color="#ffd04b">
                    <el-menu-item index="1">RulengineX</el-menu-item>
                </el-menu>
            </el-header>

            <el-main>
                <el-alert title="这是一个极其简陋的界面，因为我不会做前端，所以搞了个很简单的界面来显示一些关键信息。（按理来说这种软件不应该有界面的）" type="warning">
                </el-alert>
                <template>
                    <el-tabs v-model="activeName" @tab-click="handleClick">
                        <el-tab-pane label="系统信息" name="system">
                            <template>
                                <el-row :gutter="12">
                                    <el-col :span="8">
                                        <el-card shadow="always">
                                            CPU核心数: <h1>&{systemData.cpus}</h1>
                                        </el-card>
                                    </el-col>

                                    <el-col :span="8">
                                        <el-card shadow="always">
                                            操作系统 <h1>&{systemData.os}</h1>
                                        </el-card>
                                    </el-col>

                                    <el-col :span="8">
                                        <el-card shadow="always">
                                            硬件架构 <h1>&{systemData.arch}</h1>
                                        </el-card>
                                    </el-col>

                                </el-row>
                                <el-row :gutter="12">
                                    <el-col :span="8">
                                        <el-card shadow="always">
                                            磁盘使用率: <h1>%&{systemData.diskInfo}</h1>
                                        </el-card>
                                    </el-col>

                                    <el-col :span="8">
                                        <el-card shadow="always">
                                            内存使用率： <h1>%&{systemData.memInfo}</h1>
                                        </el-card>
                                    </el-col>

                                    <el-col :span="8">
                                        <el-card shadow="always">
                                            CPU使用率 <h1>%&{systemData.cpuPercent}</h1>
                                        </el-card>
                                    </el-col>

                                </el-row>
                            </template>
                        </el-tab-pane>
                        <el-tab-pane label="输入端管理" name="inend">
                            <template>
                                <el-table :data="inEndData" style="width: 100%">
                                    <el-table-column prop="id" label="ID" width="380">
                                    </el-table-column>
                                    <el-table-column prop="state" label="状态" width="180">
                                        <template slot-scope="scope">
                                            <el-tag v-if="scope.row.state === 0" type="danger">停止
                                            </el-tag>
                                            <el-tag v-if="scope.row.state === 1" type="success">运行
                                            </el-tag>
                                        </template>
                                    </el-table-column>
                                    <el-table-column prop="type" label="类型" width="180">
                                    </el-table-column>
                                    <el-table-column prop="name" label="名称" width="180">
                                    </el-table-column>
                                    <el-table-column prop="description" label="描述信息">
                                    </el-table-column>
                                </el-table>
                            </template>
                        </el-tab-pane>
                        <el-tab-pane label="输出端管理" name="outend">
                            <template>
                                <el-table :data="outEndData" style="width: 100%">
                                    <el-table-column prop="id" label="ID" width="380">
                                    </el-table-column>
                                    <el-table-column prop="state" label="状态" width="180">
                                        <template slot-scope="scope">
                                            <el-tag v-if="scope.row.state === 0" type="danger">停止
                                            </el-tag>
                                            <el-tag v-if="scope.row.state === 1" type="success">运行
                                            </el-tag>
                                        </template>
                                    </el-table-column>
                                    <el-table-column prop="type" label="类型" width="180">
                                    </el-table-column>
                                    <el-table-column prop="name" label="名称" width="180">
                                    </el-table-column>
                                    <el-table-column prop="description" label="描述信息">
                                    </el-table-column>
                                </el-table>
                            </template>
                        </el-tab-pane>
                        <el-tab-pane label="规则管理" name="rule">
                            <template>
                                <el-table :data="ruleData" style="width: 100%">
                                    <el-table-column prop="id" label="ID" width="380">
                                    </el-table-column>
                                    <el-table-column prop="name" label="名称" width="180">
                                    </el-table-column>
                                    <el-table-column prop="from" label="绑定资源" width="180">
                                    </el-table-column>
                                    <el-table-column prop="description" label="描述信息">
                                    </el-table-column>
                                </el-table>
                            </template>
                        </el-tab-pane>
                        <el-tab-pane label="插件管理" name="plugin"><template>
                                <el-table :data="pluginData" style="width: 100%">
                                    <el-table-column prop="name" label="插件名称" width="180">
                                    </el-table-column>
                                    <el-table-column prop="version" label="版本" width="180">
                                    </el-table-column>
                                    <el-table-column prop="homepage" label="插件主页" width="180">
                                    </el-table-column>
                                    <el-table-column prop="helpLink" label="帮助文档" width="180">
                                    </el-table-column>
                                    <el-table-column prop="author" label="作者" width="180">
                                    </el-table-column>
                                    <el-table-column prop="email" label="Email" width="180">
                                    </el-table-column>
                                    <el-table-column prop="license" label="协议">
                                    </el-table-column>
                                </el-table>
                            </template></el-tab-pane>
                    </el-tabs>
                </template>
            </el-main>

        </el-container>

    </div>
</body>
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script>
    new Vue({
        el: '#app',
        delimiters: ['&{', '}'],
        data() {
            return {
                activeName: 'system',
                systemData: {
                    "diskInfo": 0,
                    "memInfo": 0,
                    "cpuPercent": 0,
                    "arch": "unknown",
                    "cpus": 0,
                    "os": "unknown"
                },
                inEndData: [],
                outEndData: [],
                ruleData: [],
                pluginData: [],

            };
        },
        mounted() {
            let thiz = this;
            axios.get('http://127.0.0.1:2580/api/v1/system')
                .then(response => {
                    thiz.systemData = response.data
                    console.log(response.data)
                })
        },
        methods: {
            handleClick(tab, event) {
                let thiz = this;
                switch (tab.name) {
                    case "inend":
                        axios.get('http://127.0.0.1:2580/api/v1/inends')
                            .then(response => {
                                thiz.inEndData = Object.values(response.data.inends)
                            })
                        break;

                    case "outend":
                        axios.get('http://127.0.0.1:2580/api/v1/outends')
                            .then(response => {
                                thiz.outEndData = Object.values(response.data.outends)

                            })
                        break;

                    case "plugin":
                        axios.get('http://127.0.0.1:2580/api/v1/plugins')
                            .then(response => {
                                thiz.pluginData = Object.values(response.data.plugins)
                            })
                        break;

                    case "system":
                        axios.get('http://127.0.0.1:2580/api/v1/system')
                            .then(response => {
                                thiz.systemData = response.data
                            })
                        break;
                    case "rule":
                        axios.get('http://127.0.0.1:2580/api/v1/rules')
                            .then(response => {
                                thiz.ruleData = Object.values(response.data.rules)
                            })
                        break;

                    default:
                        break;
                }
            }
        }
    })
</script>

</html>